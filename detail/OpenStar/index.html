
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="更好的可读性和视觉效果,优雅的与源项目404StarLink保持同步。">
      
      
        <meta name="author" content="探姬">
      
      
        <link rel="canonical" href="https://StarLink.tjsec.cn/detail/OpenStar/">
      
      
        <link rel="prev" href="../MysqlT/">
      
      
        <link rel="next" href="../passive-scan-client/">
      
      
      <link rel="icon" href="../../assets/logo_star.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.11">
    
    
      
        <title>OpenStar - Better_StarLink</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans SC";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openstar-httpsgithubcomstarjunopenstar" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Better_StarLink" class="md-header__button md-logo" aria-label="Better_StarLink" data-md-component="logo">
      
  <img src="../../assets/logo_star.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Better_StarLink
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OpenStar
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ProbiusOfficial/Better_StarLink" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Better_StarLink
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  主页

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  项目目录及细节

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../column/" class="md-tabs__link">
          
  
    
  
  Kcon兵器谱

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../Raiders/" class="md-tabs__link">
        
  
    
  
  星际奇兵

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Better_StarLink" class="md-nav__button md-logo" aria-label="Better_StarLink" data-md-component="logo">
      
  <img src="../../assets/logo_star.png" alt="logo">

    </a>
    Better_StarLink
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ProbiusOfficial/Better_StarLink" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Better_StarLink
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    主页
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            主页
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../party_a/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    甲方工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reconnaissance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    信息收集
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information_analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    信息分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vulnerability_assessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    漏洞探测
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../penetration_test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    攻击与利用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intranet_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内网工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    其他
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    项目目录及细节
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            项目目录及细节
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../afrog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    afrog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Antenna/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Antenna
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../antSword/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    antSword
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AppInfoScanner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AppInfoScanner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appshark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    appshark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../As-Exploits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    As-Exploits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../BinAbsInspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BinAbsInspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../BurpCrypto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BurpCrypto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../camille/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    camille
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CDK/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CDK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud-Bucket-Leak-Detection-Tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud-Bucket-Leak-Detection-Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CodeReviewTools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CodeReviewTools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cola-Dnslog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cola-Dnslog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ct
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DNSlog-GO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNSlog-GO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dperf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dperf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Elkeid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elkeid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ENScanGo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ENScanGo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../f8x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    f8x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frida-skeleton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    frida-skeleton
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Glass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gshark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gshark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HackBrowserData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HackBrowserData
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Hades/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HaE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HaE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Heimdallr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heimdallr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../java-object-searcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    java-object-searcher
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../js-cookie-monitor-debugger-hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    js-cookie-monitor-debugger-hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Juggler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Juggler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../JYso/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JYso
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ksubdomain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ksubdomain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KunLun-M/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KunLun-M
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kunpeng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kunpeng
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kunyu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kunyu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LBot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LBot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linglong/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linglong
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LSpider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LSpider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MDUT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MDUT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../murphysec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    murphysec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../myscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    myscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MySQL-Fake-Server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MySQL-Fake-Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MySQLMonitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MySQLMonitor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MysqlT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MysqlT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    OpenStar
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    OpenStar
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#openstar-httpsgithubcomstarjunopenstar" class="md-nav__link">
    <span class="md-ellipsis">
      OpenStar https://github.com/starjun/openstar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      非开源版本 【带后台、带 4 层防护模块等...】完全免费！！！
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      变更历史
    </span>
  </a>
  
    <nav class="md-nav" aria-label="变更历史">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#17-next" class="md-nav__link">
    <span class="md-ellipsis">
      1.7 更新二阶匹配规则支持取反，动作取消next等
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17111-post_form" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.1.11 更新规则匹配等于判断表达式支持("="),post_form支持("*")对所有表单名称进行匹配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17110" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.1.10 更新支持基于业务属性进行限速的功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.7.1.10 更新支持基于业务属性进行限速的功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1711-host_mod" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.1.1 修改 host_Mod 规则匹配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17024-table-listlist-dict" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.0.24 原规则匹配变更：table--&gt;list;list--&gt;dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-count_dictdb-2key" class="md-nav__link">
    <span class="md-ellipsis">
      1.6 更新计数count_dict到DB 2,key也进行分开，优化规则缓存
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-masterslave" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 应一些朋友强烈要求增加Master/Slave模式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 更新命名相关，以多规则匹配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-set-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 更新跳转功能，可配置进行set-cookie操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-csrf" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 更新支持拦截外部的csrf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-app_modallowip" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 增加app_Mod,丰富allow动作（ip）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#09-10" class="md-nav__link">
    <span class="md-ellipsis">
      0.9 - 1.0 修改了大量全局函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#08" class="md-nav__link">
    <span class="md-ellipsis">
      0.8 优化一下算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#07" class="md-nav__link">
    <span class="md-ellipsis">
      0.7 增加集群版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#06-api" class="md-nav__link">
    <span class="md-ellipsis">
      0.6 增加API相关操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#04-05" class="md-nav__link">
    <span class="md-ellipsis">
      0.4-0.5 增加配置文件操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#03-waf" class="md-nav__link">
    <span class="md-ellipsis">
      0.3 增加waf防护模块
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#02-cc" class="md-nav__link">
    <span class="md-ellipsis">
      0.2 CC防护应用层版
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#01-cc" class="md-nav__link">
    <span class="md-ellipsis">
      0.1 CC防护版
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#top" class="md-nav__link">
    <span class="md-ellipsis">
      TOP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TOP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      重点
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      概览
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#waf" class="md-nav__link">
    <span class="md-ellipsis">
      WAF防护
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cc" class="md-nav__link">
    <span class="md-ellipsis">
      CC/采集防护
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CC/采集防护">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      攻击类型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      防护方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      目录
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      下载
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      安装
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      配置规则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      执行流程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-0-realipfrom_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 0 : realIpFrom_Mod 
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1ip_modlog" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 1：ip_Mod（黑/白名单、log记录）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2host_method_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 2：host_method_Mod（白名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-rewrite_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 3: rewrite_Mod（跳转模块）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4host_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 4：host_Mod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5app_modaction" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 5：app_Mod（自定义action）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6referer_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 6：referer_Mod（白名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7uri_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 7：uri_Mod（黑、白名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8header_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 8：header_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9useragent_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 9：useragent_Mod （黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10cookie_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 10：cookie_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11args_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 11：args_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12post_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 12：post_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-13network_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 13：network_Mod（频率黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-14replace_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 14：replace_Mod（内容替换）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      API相关
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      样例
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      性能评测
    </span>
  </a>
  
    <nav class="md-nav" aria-label="性能评测">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      项目相关
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      最近更新
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../passive-scan-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    passive-scan-client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platypus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Platypus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Pocassist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pocassist
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pocsuite3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pocsuite3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PortForward/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PortForward
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rakshasa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rakshasa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Redis-Rogue-Server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis-Rogue-Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaninfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scaninfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ServerScan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ServerScan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shellcodeloader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shellcodeloader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Stowaway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stowaway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tai-e/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tai-e
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vArmor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vArmor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../veinmind-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    veinmind-tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Viper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WMIHACKER/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WMIHACKER
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ysomap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ysomap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZoomEye-go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZoomEye-go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZoomEye-Python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZoomEye-Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ZoomEye-Tools." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZoomEye-Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../column/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Kcon兵器谱
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Kcon兵器谱
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../column/2021KCon_exhibition_with_starlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kcon2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../column/2022KCon_exhibition_with_starlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kcon2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../column/2023KCon_exhibition_with_starlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kcon2023
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Raiders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    星际奇兵
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#openstar-httpsgithubcomstarjunopenstar" class="md-nav__link">
    <span class="md-ellipsis">
      OpenStar https://github.com/starjun/openstar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      非开源版本 【带后台、带 4 层防护模块等...】完全免费！！！
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      变更历史
    </span>
  </a>
  
    <nav class="md-nav" aria-label="变更历史">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#17-next" class="md-nav__link">
    <span class="md-ellipsis">
      1.7 更新二阶匹配规则支持取反，动作取消next等
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17111-post_form" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.1.11 更新规则匹配等于判断表达式支持("="),post_form支持("*")对所有表单名称进行匹配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17110" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.1.10 更新支持基于业务属性进行限速的功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.7.1.10 更新支持基于业务属性进行限速的功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1711-host_mod" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.1.1 修改 host_Mod 规则匹配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17024-table-listlist-dict" class="md-nav__link">
    <span class="md-ellipsis">
      1.7.0.24 原规则匹配变更：table--&gt;list;list--&gt;dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-count_dictdb-2key" class="md-nav__link">
    <span class="md-ellipsis">
      1.6 更新计数count_dict到DB 2,key也进行分开，优化规则缓存
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-masterslave" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 应一些朋友强烈要求增加Master/Slave模式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 更新命名相关，以多规则匹配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-set-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 更新跳转功能，可配置进行set-cookie操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-csrf" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 更新支持拦截外部的csrf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-app_modallowip" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 增加app_Mod,丰富allow动作（ip）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#09-10" class="md-nav__link">
    <span class="md-ellipsis">
      0.9 - 1.0 修改了大量全局函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#08" class="md-nav__link">
    <span class="md-ellipsis">
      0.8 优化一下算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#07" class="md-nav__link">
    <span class="md-ellipsis">
      0.7 增加集群版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#06-api" class="md-nav__link">
    <span class="md-ellipsis">
      0.6 增加API相关操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#04-05" class="md-nav__link">
    <span class="md-ellipsis">
      0.4-0.5 增加配置文件操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#03-waf" class="md-nav__link">
    <span class="md-ellipsis">
      0.3 增加waf防护模块
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#02-cc" class="md-nav__link">
    <span class="md-ellipsis">
      0.2 CC防护应用层版
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#01-cc" class="md-nav__link">
    <span class="md-ellipsis">
      0.1 CC防护版
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#top" class="md-nav__link">
    <span class="md-ellipsis">
      TOP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TOP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      重点
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      概览
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#waf" class="md-nav__link">
    <span class="md-ellipsis">
      WAF防护
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cc" class="md-nav__link">
    <span class="md-ellipsis">
      CC/采集防护
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CC/采集防护">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      攻击类型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      防护方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      目录
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      下载
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      安装
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      配置规则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      执行流程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-0-realipfrom_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 0 : realIpFrom_Mod 
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1ip_modlog" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 1：ip_Mod（黑/白名单、log记录）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2host_method_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 2：host_method_Mod（白名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-rewrite_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 3: rewrite_Mod（跳转模块）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4host_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 4：host_Mod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5app_modaction" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 5：app_Mod（自定义action）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6referer_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 6：referer_Mod（白名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7uri_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 7：uri_Mod（黑、白名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8header_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 8：header_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9useragent_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 9：useragent_Mod （黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10cookie_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 10：cookie_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11args_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 11：args_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12post_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 12：post_Mod（黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-13network_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 13：network_Mod（频率黑名单）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-14replace_mod" class="md-nav__link">
    <span class="md-ellipsis">
      STEP 14：replace_Mod（内容替换）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      API相关
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      样例
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      性能评测
    </span>
  </a>
  
    <nav class="md-nav" aria-label="性能评测">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      项目相关
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      最近更新
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/ProbiusOfficial/Better_StarLink/tree/main/docs/detail/OpenStar.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/ProbiusOfficial/Better_StarLink/tree/main/docs/detail/OpenStar.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h2 id="openstar-httpsgithubcomstarjunopenstar">OpenStar <a href="https://github.com/starjun/openstar">https://github.com/starjun/openstar</a><a class="headerlink" href="#openstar-httpsgithubcomstarjunopenstar" title="Permanent link">&para;</a></h2>
<!--auto_detail_badge_begin_0b490ffb61b26b45de3ea5d7dd8a582e-->
<p><img alt="Language" src="https://img.shields.io/badge/Language-JS/Python-blue" />
<img alt="Author" src="https://img.shields.io/badge/Author-starjun-orange" />
<img alt="GitHub stars" src="https://img.shields.io/github/stars/starjun/openstar.svg?style=flat&amp;logo=github" />
<img alt="Version" src="https://img.shields.io/badge/Version-V1.0.0-red" />
<img alt="Time" src="https://img.shields.io/badge/Join-20210702-green" /></p>
<!--auto_detail_badge_end_fef74f2d7ea73fcc43ff78e05b1e7451-->

<p>欢迎使用 <strong>{OpenStar}(WAF+)</strong>，该项目是从实际需求中产生，经过多次的版本迭代，实属不易。感谢**春哥**，以及<a href="https://github.com/agentzh">春哥</a>的神器（<strong><a href="http://openresty.org/cn/">OpenResty</a></strong>）
注意：使用版本一定要大于 1.11.0 因为使用了ngx.var.request_id
<strong>代码写的比较好理解，肯定不优雅  哈~</strong></p>
<p>个人的一些开发实践，有需要的朋友可以加入下
<img alt="xq" src="https://github.com/starjun/openstar/raw/master/doc/xq.jpg" title="xq.jpg" /></p>
<p>正在更新说明WIKI篇,已经更新了安装篇，请自行查阅。</p>
<p>更新：规则支持方式
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>支持并行正则匹配(使用 https://github.com/cloudflare/lua-aho-corasick 实现)
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>增加：并行正则(&quot;aho&quot;) -- 列表
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>&quot;host&quot;:[[
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>          &quot;^www.baidu&quot;,
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>          &quot;.*.baidu.com$&quot;
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        ],
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>            &quot;aho&quot;
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        ]
</span></code></pre></div></p>
<p>更新：规则支持方式
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>现有：等于(&quot;&quot;) 包含(&quot;in&quot;) 列表(&quot;list&quot;) 字典(&quot;dict&quot;) 正则(&quot;jio|jo|***&quot;)
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>增加：开头列表(&quot;start_list&quot;) -- 以什么什么开头列表
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>      不区分大小写 开头列表(&quot;ustart_list&quot;)
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>      结尾列表(&quot;end_list&quot;)  -- 以什么什么结尾列表
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>      不区分大小写 结尾列表(&quot;uend_list&quot;)
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>      包含列表(&quot;in_list&quot;)   -- 包含的列表形式
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>      不区分大小写包含列表(&quot;uin_list&quot;)  --in_list扩展(不区分大小写)
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>      【json 同 list 一样】
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>增加：长度(&quot;len&quot;) [Min,Max] 表示大于等于 Min,且小于等于 Max
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>EG：
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>&quot;host&quot;:[[
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>          &quot;www.baidu.&quot;,
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>          &quot;img.baidu.&quot;
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>        ],
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>            &quot;start_list&quot;
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>        ]
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>&quot;referer&quot;:[[0,150],&quot;len&quot;]   --- referer 长度 在 0~150 之间
</span></code></pre></div></p>
<h1 id="4">非开源版本 【带后台、带 4 层防护模块等...】完全免费！！！<a class="headerlink" href="#4" title="Permanent link">&para;</a></h1>
<p><a href="https://www.kancloud.cn/openstar/install/1136671">https://www.kancloud.cn/openstar/install/1136671</a></p>
<h1 id="_1">变更历史<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="17-next">1.7 更新二阶匹配规则支持取反，动作取消next等<a class="headerlink" href="#17-next" title="Permanent link">&para;</a></h2>
<p>原二阶规则：["baidu","in"],支持取反后：["baidu","in",true];最后的默认是nil也就是false,不取反的意思，所以规则基本可以之间复用，动作为next的需要修改一下即可</p>
<h2 id="17111-post_form">1.7.1.11 更新规则匹配等于判断表达式支持("="),post_form支持("*")对所有表单名称进行匹配<a class="headerlink" href="#17111-post_form" title="Permanent link">&para;</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>[&quot;post_form&quot;,[&quot;(;|-|/)&quot;,&quot;jio&quot;,[&quot;*&quot;,2],false]] 对表单所有名称的文件名进行匹配
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>[&quot;www.test.com&quot;,&quot;&quot;]
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>[&quot;www.test.com&quot;,&quot;=&quot;] 新增加表达方式
</span></code></pre></div>
<h2 id="17110">1.7.1.10 更新支持基于业务属性进行限速的功能<a class="headerlink" href="#17110" title="Permanent link">&para;</a></h2>
<p>network_Mod: <code>"network":{"maxReqs":30,"pTime":10,"blackTime":600,"guid":"cookie_userguid"}</code>，业务代码ngx.var[%guid%]，实际上是从ngx.var中去值进行限速操作，所以一定要配置正常；这里表示从cookie中名称为userguid的值进行频率统计来限速。默认则是用ip限速</p>
<h3 id="1711-host_mod">1.7.1.1 修改 host_Mod 规则匹配<a class="headerlink" href="#1711-host_mod" title="Permanent link">&para;</a></h3>
<p>目前只有两种规则（app_ext | network） 请参考 conf_json/host_json/101.200.122.200.json</p>
<h3 id="17024-table-listlist-dict">1.7.0.24 原规则匹配变更：table&rarr;list;list&rarr;dict<a class="headerlink" href="#17024-table-listlist-dict" title="Permanent link">&para;</a></h3>
<p>方便理解list表示序列，dict表示字典。
EG：
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>&quot;method&quot;:[
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>            {
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>                &quot;POST&quot;:true,
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>                &quot;GET&quot;:true
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>            },
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>            &quot;dict&quot; --- 原 list
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>        ]
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>&quot;ips&quot;: [[
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>            &quot;101.254.241.149&quot;,
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>            &quot;106.37.236.170&quot;],
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>            &quot;list&quot; --- 原 table
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>        ]
</span></code></pre></div></p>
<h2 id="16-count_dictdb-2key">1.6 更新计数count_dict到DB 2,key也进行分开，优化规则缓存<a class="headerlink" href="#16-count_dictdb-2key" title="Permanent link">&para;</a></h2>
<p>规则进行了缓存，大幅提高性能，json文件保存进行了美化等......</p>
<h2 id="15-masterslave">1.5 应一些朋友强烈要求增加Master/Slave模式<a class="headerlink" href="#15-masterslave" title="Permanent link">&para;</a></h2>
<p>主：定时将内存中的配置推送到redis, 从：定时从redis拉取数据到内存后，并保存到文件</p>
<h2 id="14">1.4 更新命名相关，以多规则匹配<a class="headerlink" href="#14" title="Permanent link">&para;</a></h2>
<p>原来url改成uri，args改成query_string，修改的比较多，还有增加app_Mod实现多规则匹配，连接符支持OR</p>
<h2 id="13-set-cookie">1.3 更新跳转功能，可配置进行set-cookie操作<a class="headerlink" href="#13-set-cookie" title="Permanent link">&para;</a></h2>
<p>可以配置某一个或者多个url使用跳转set-cookie操作。cookie是无状态的。</p>
<h2 id="12-csrf">1.2 更新支持拦截外部的csrf<a class="headerlink" href="#12-csrf" title="Permanent link">&para;</a></h2>
<p>在referer_Mod处，增加action，<code>allow</code>表示允许且后续的规则不用在匹配（一般是静态资源如图片/js/css等），<code>next</code>表示白名单匹配成功后，会继续后面的规则匹配（这里就用于拦截外部的CSRF）增加<code>next</code>是因为原来代码中，若配置了防护站外的CSRF，后续的规则会bypass,所以增加的，这样就不会出现一些绕过问题。
<strong>后续的action理论上都支持该语法</strong></p>
<h2 id="11-app_modallowip">1.1 增加app_Mod,丰富allow动作（ip）<a class="headerlink" href="#11-app_modallowip" title="Permanent link">&para;</a></h2>
<p>网站的某个目录进行IP白名单的访问控制（后台、phpmyadmin等）</p>
<h2 id="09-10">0.9 - 1.0 修改了大量全局函数<a class="headerlink" href="#09-10" title="Permanent link">&para;</a></h2>
<p>在学习完<a href="https://moonbingbing.gitbooks.io/openresty-best-practices/content/index.html">OpenResty最佳实践</a>后，代码太不专业，修改了大量全局变量、函数</p>
<h2 id="08">0.8 优化一下算法<a class="headerlink" href="#08" title="Permanent link">&para;</a></h2>
<p>原来args是遍历每个参数在连接起来，感觉性能有时有点瓶颈，就使用新api取出url中的所有参数，经过测试效果要比原来好很多。</p>
<h2 id="07">0.7 增加集群版本<a class="headerlink" href="#07" title="Permanent link">&para;</a></h2>
<p>当时大约有2-4台OpenStar服务器用于安全防护，通过脚本进行统一管理的，没有进行真正的统一管理，所以抽空的时候把redis用上。</p>
<h2 id="06-api">0.6 增加API相关操作<a class="headerlink" href="#06-api" title="Permanent link">&para;</a></h2>
<p>因为是个蹩脚的程序员（没办法，搞安全的现在都被逼的写代码了；感谢春哥，我在写的过程中非常的快乐，所以就把项目叫做OpenStar[开心]，请勿见笑了）、前端界面我迟迟没有想好，所以先把一下操作的API封装了，也满足当时公司脚本化需求。</p>
<h2 id="04-05">0.4-0.5 增加配置文件操作<a class="headerlink" href="#04-05" title="Permanent link">&para;</a></h2>
<p>刚开始都是写在lua代码中，随着功能增加，决定通过配置文件进行操作，所有就使用json方式进行定义配置文件。</p>
<h2 id="03-waf">0.3 增加waf防护模块<a class="headerlink" href="#03-waf" title="Permanent link">&para;</a></h2>
<p>随着cc防护成功后，我陆续增加了waf相关的功能，规则参考了<a href="http://www.modsecurity.org/">modsecurity</a>、<a href="https://github.com/loveshell/ngx_lua_waf">loveshell</a>防护模块、以及互联网搜集的一些过滤点</p>
<h2 id="02-cc">0.2 CC防护应用层版<a class="headerlink" href="#02-cc" title="Permanent link">&para;</a></h2>
<p>通过网络层+应用层的防护后，我后续增加了应用层的安全防护，如应用层set cookie、url跳转、js跳转等这样应用层的防护模块</p>
<h2 id="01-cc">0.1 CC防护版<a class="headerlink" href="#01-cc" title="Permanent link">&para;</a></h2>
<p>当时是为了解决公司的CC攻击，由于一些硬件抗D设备在新的网络环境下（有CDN网络下）无法获取用户真实IP头，我才动手将第一个版本完成，当时功能就是有通过自定义HTTP头获取用户真实ip进行访问频率的限制。（OpenStar可以根据某个url进行频率限制，不仅仅是整个网站的[排除静态文件，如设置了referer_Mod 或者 url_Mod 中资源的allow操作]）</p>
<h1 id="top">TOP<a class="headerlink" href="#top" title="Permanent link">&para;</a></h1>
<p><a href="https://github.com/starjun/openstar/wiki/%E5%AE%89%E8%A3%85%E7%AF%87">安装篇</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/base.json">基础配置说明</a> base.json</p>
<p><a href="https://github.com/starjun/openstar/wiki/0-realIpFrom_Mod">STEP 0：realIpFrom_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/1-ip_Mod">STEP 1：ip_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/2-host_method_Mod">STEP 2：host_method_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/3-rewrite_Mod">STEP 3：rewrite_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/4-host_Mod">STEP 4：host_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/5-app_Mod">STEP 5：app_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/6-referer_Mod">STEP 6：referer_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/7-uri_Mod">STEP 7：uri_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/8-header_Mod">STEP 8：header_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/9-useragent_Mod">STEP 9：useragent_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/10-cookie_Mod">STEP 10：cookie_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/11-args_Mod">STEP 11：args_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/12-post_Mod">STEP 12：post_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/13-network_Mod">STEP 13：network_Mod</a></p>
<p><a href="https://github.com/starjun/openstar/wiki/14-replace_Mod">STEP 14：replace_Mod</a></p>
<p>一些同学问的比较多的问题：</p>
<p>0：规则组问题
支持IFTTT模式，如条件是（referer中包含baidu 或者 cookie中不包含abc 且useragent正则匹配spider）等等这样复杂的表达式，执行动作也是有多个可以使用(deny allow log refile rehtml relua*)可以定制各种复杂的场景</p>
<p>1：关于多站点的事</p>
<p>使用ngx本身的增加配置文件就不说了，使用动态upstream可以参考我另外的项目https://github.com/starjun/dynamic_upstream-by-balancer
一些接口没有加上去，看看代码自己非常容易搞定了。反向代理的host和后端的IP组都在DICT中（注意是IP组，而不仅仅是类似一些balancer写动态upstream的是一个IP），且支持多种负载均衡方式，相信可以满足大多数需求。https的后面有时间我在完善下。</p>
<p>2：集群相关(提供了Master/Slave配置)</p>
<p>目前openstar是支持集群的，规则同步和下发等都是提供了api，都是被动方式，规则为什么没有放到redis中，请自己测试一下，每次规则过滤都从redis取后在序列化，和从dict取在序列化，自己动手测试看性能，顺便说下，规则在集群下当然存在redis中，都是通过api进行操作更新到dict中，而不是每次都从redis中取，且最近增加了定时从redis拉取配置功能（测试中...）</p>
<p>3：如有一些技术类问题，请尽量完整一些，包括ngx配置文件，和比较完整的代码，不然真心不好作答，有时间我会尽量回复（不一定是对的），没时间回复的请谅解。</p>
<p>admin@17173.com邮箱已经没有在用了，请不要给这个发邮箱啦。</p>
<h2 id="todo">TODO<a class="headerlink" href="#todo" title="Permanent link">&para;</a></h2>
<p>无</p>
<p>商业版说明：</p>
<p><strong>支持域名管理，支持geoip（按国家，城市进行拦截等），支持SQL语义分析(功能完善中)，更强大的api接口，默认规则更强大等等</strong></p>
<hr />
<p>CC防护、防抓取、刷单等防护算法：</p>
<p>CC攻击点：</p>
<p>a：用户可直接访问的url(搜索请求[数据库查询]，高计算[cpu计算]，随机url[耗连接]等)</p>
<p>b：嵌入类型的url(嵌入的验证码url[CPU计算]、ajax判断用户是否存在的url[数据库查询]等)</p>
<p>c：非浏览器类型的接口(一些公共API、WEBservice等无SDK的接口)</p>
<p>d：特定语言、服务器的攻击(php dos、慢速攻击等)</p>
<p>我提供的防护算法是用于防护a、b类型的攻击，a类型防护启用时，可以先生成一个添加标记的跳转页面，b类型防护启用时，动态对其渲染页面进行标记的添加，c类型有sdk，自己写代码支持自己设定的防护算法的不是问题。</p>
<p>js静态、动态验证：</p>
<p>跳转页面/渲染页面对下一次请求的url进行标记增加（openstar已经实现的增加url尾巴），增加一个get的args参数，参数名称和值都是由服务器产生或者前端页面js产生，如对下一次请求的url增加<code>cc=1ldldj</code>这个尾巴，服务端判断合法性有静态的正则判断值的合法性，有动态的判断值是否由服务器生成的,合法性检查更加严格。</p>
<p>js增强：（获取鼠标轨迹、鼠标点击事件、随机延迟、基于特定浏览器对js的方言）</p>
<p>普通的js一些攻击软件或者爬虫工具是可以分析执行的，故可以进行js增加，如判断鼠标轨迹、鼠标点击事件这些事件判断失败就不会进行下一步请求；如基于浏览器的js方言，一些浏览器会有自己的方言，那些爬虫工具和攻击工具是不可能解析js方言的，就不会进行下一步请求；还有使用js随机延迟函数，用于下一次请求的时间分流，这样请求频率就会被分开，这样就缓解了请求频率，以及结合鼠标轨迹和鼠标事件判断，可以很好的识别工具和人。</p>
<p>浏览器指纹：（对浏览器会生成一个唯一指纹，从而判断链式请求指纹的一致性）
广告厂商来做这件事就事半功倍了，毕竟浏览器指纹在整个互联网的数据还是很有参考价值的，毕竟不是要指纹对应的广告标签等这些商业价值数据，仅是需要一个指纹的信誉库（同IP信誉库类似，当然也有时效性），因为CC攻击和一些爬虫、刷单工具在互联网上的指纹还是非常清晰的。
情况可以公司可以建立自己的体系，对CC攻击、页面抓取、刷单是有相当大的帮助的，以后各大公司可以共享这些浏览器指纹数据，组成一个联盟也行，从而判断该指纹是否是真实用户等一些可用数据。</p>
<p><a href="http://123.57.220.116/fgjs2.html">http://123.57.220.116/fgjs2.html</a> 看看自己的浏览器指纹吧(如果访问不了，哈，我买的ECS过期了！)</p>
<p>参考：<a href="https://github.com/Valve/fingerprintjs2">https://github.com/Valve/fingerprintjs2</a></p>
<p>控件/浏览器防护:</p>
<p>使用js进行下一次请求的跳转，以及增强的鼠标轨迹、鼠标事件、浏览器js方言等这些判断还是有一定的缺陷，故可以直接使用控件方式、或者和浏览器合作（浏览器支持这种防护标记）</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>PS：简单举个例子
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>http://www.cc.com?cc=@{&quot;api&quot;:&quot;http://1.1.1.1/cc/api&quot;,&quot;key&quot;:&quot;iodjdjkdldskl&quot;}@
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>http://www.cc.com?cc=@{&quot;api&quot;:&quot;tcp://1.1.1.1:908&quot;,&quot;key&quot;:&quot;iodjdjkdldskl&quot;}@
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>http://www.cc.com?cc=@{&quot;api&quot;:&quot;local&quot;,&quot;key&quot;:&quot;1:2345:44&quot;}@
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>跳转页面或者渲染页面，控件/浏览器是可以识别@中间的内容的，向这个api使用key取到一个值，下一次请求带上这个值。
</span></code></pre></div>
<p>i：set 一个cookie,其合法性是由控件和web服务器双向约定或加密产生，从而判断下一次请求是否合法</p>
<p>ii：增加args参数尾巴，其value值合法性由控件和web服务器双向约定或加密产生，从而判断下一次请求是否合法</p>
<p>iii：增加POST参数，其value值合法性由控件和web服务器双向约定或加密产生，等等对下一次请求进行验证增加</p>
<h2 id="_2">重点<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>这些防护算法我正在申请相关专利，个人用户以后永久免费的，仅对企业收费，请抄袭党，无耻公司放过小弟一码。</p>
<p>这些防护算法我正在申请相关专利，个人用户以后永久免费的，仅对企业收费，请抄袭党，无耻公司放过小弟一码。</p>
<p>这些防护算法我正在申请相关专利，个人用户以后永久免费的，仅对企业收费，请抄袭党，无耻公司放过小弟一码。</p>
<h1 id="_3">概览<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<hr />
<p><strong>OpenStar**是一个基于<a href="http://openresty.org/cn/">OpenResty</a>的，高性能WAF，还相应增加了其他灵活、友好、实用的功能，是增强的WAF。
**app_Mod 支持规则组 连接符支持 or , 参考doc/demo.md文档</strong></p>
<h1 id="waf">WAF防护<a class="headerlink" href="#waf" title="Permanent link">&para;</a></h1>
<hr />
<p>在**OpenStar**中的WAF防护模块，采用传统的字符串的匹配如正则过滤、包含等（<em>有人会问现在不是流行自主学习么；正则、包含等会有盲点、会被绕过；WAF的误报和漏报问题等等......</em>）。<strong>规则不是万能的，但是没有规则是万万不能的</strong> 这里我简单说明一下，自主分析学习引擎是我们的日志分析引擎做的（预留了api可实时增加拦截），这里是高性能、高并发的点，就用简单快速的方法解决，且根据业务实际调整好防护策略，可以解决绝大多数WEB安全1.0和WEB安全2.0类型的漏洞（90%+的问题）。
WAF 防护从header,args,post,访问频率等，分层进行按顺序防护，详细在后面的功能会详细说明</p>
<ul>
<li>
<p><strong>WEB安全1.0</strong>
   在1.0时代下，攻击是通过服务器漏洞（IIS6溢出等）、WEB应用漏洞（SQL注入、文件上传、命令执行、文件包含等）属于服务器类的攻击，该类型漏洞虽然经历了这么多年，很遗憾，此类漏洞还是存在，并且重复在犯相同的错误。</p>
</li>
<li>
<p><strong>WEB安全2.0</strong>
   随着社交网络的兴起，原来不被重视的XSS、CSRF等漏洞逐渐进入人们的视野，那么在2.0时代，漏洞利用的思想将更重要，发挥你的想象，可以有太多可能。</p>
</li>
<li>
<p><strong>WEB安全3.0</strong>
   同开发设计模式类似（界面、业务逻辑、数据），3.0将关注应用本身的业务逻辑和数据安全，如密码修改绕过、二级密码绕过、支付类漏洞、刷钱等类型的漏洞，故注重的是产品本身的业务安全、数据安全、风控安全等。</p>
</li>
</ul>
<blockquote>
<p><code>安全不仅仅是在技术层面、还应该在行政管理层面、物理层面去做好安全的防护，才能提供最大限度的保护。</code>
安全行业多年的从业经验：人，才是最大的威胁；无论是外部、内部、无心、有意过失。（没有丑女人、只有懒女人）我想可以套用在此处，纯属个人见解。</p>
</blockquote>
<h1 id="cc">CC/采集防护<a class="headerlink" href="#cc" title="Permanent link">&para;</a></h1>
<p>什么是**CC攻击**，简单的说一下，就是用较少的代价恶意请求web（应用）中的重资源消耗点（CPU/IO/数据库等等）从而达到拒绝服务的目的；<strong>数据采集</strong>，就是内容抓取了，简单这么理解吧</p>
<blockquote>
<p><code>非官方学术类的解释，先将就理解下</code>
<strong>关于本文对CC攻击的分析和相关的防护算法，都是我在实战中分析总结，并形成自己的方法论，不足之处、欢迎指正。</strong></p>
</blockquote>
<h2 id="_4">攻击类型<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li>行为（GET、POST等）
  目前主要还是这两中method攻击为主，其他的少之又少。</li>
<li>
<p>被攻击的点</p>
<p>1：用户可直接访问的URL（搜索、重CPU计算、IO、数据库操作等）</p>
<p>2：嵌入的URL（验证码、ajax接口等）</p>
<p>3：面向非浏览器的接口（一些API、WEBservice等）</p>
<p>4：基于特定web服务、语言等的特定攻击（慢速攻击、PHP-dos等）</p>
</li>
</ul>
<blockquote>
<p><code>面对CC攻击我们需要根据实际情况采用不同的防护算法，比如攻击的点是一个ajax点，你使用js跳转/验证码肯定就有问题</code></p>
</blockquote>
<h2 id="_5">防护方法<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>网络层
 通过访问ip的频率、统计等使用阀值的方式进行频率和次数的限制，黑名单方式</p>
</li>
<li>
<p>网络层+应用层
 在后来的互联网网络下，有了的CDN加入，现在增加的网络层的防护需要扩展，那么统计的IP将是在HTTP头中的IP，仍然使用频率、次数、黑名单的方式操作。</p>
<blockquote>
<p><code>但是很多厂家的硬件流量清洗等设备，有的获取用户真实IP从HTTP头中取的是固定字段（X-FOR-F），不能自定义，更甚至有的厂家就没有该功能，这里就不说具体的这些厂家名字了</code>PS: 在传统的4层防护上，是没有问题的</p>
</blockquote>
</li>
<li>
<p>应用层
TAG验证、SET COOKIE、URL跳转、JS跳转、验证码、页面嵌套、强制静态缓存等
防护是需要根据攻击点进行分别防护的，如攻击的是嵌入的url，我们就不能使用JS跳转、302验证码等这样的方法；<strong>在多次的CC防护实战中，如使用url跳转、set cookie，在新型的CC攻击下，这些防护都已经失效了</strong>。后面我会分享一下我的防护算法，并且在**OpenStar**中已经可以根据情况实现我所说的防护算法。
浏览器是可以执行JS和flash的，这里我分享一些基于JS的防护算法，flash需要自己去写（比js复杂一些），可以实现flash应用层的安全防护和防页面抓取（开动你的大脑吧）</p>
</li>
</ul>
<p>1：客户端防护
使用JS进行前端的防护（浏览器识别、鼠标轨迹判断、url有规则添加尾巴（args参数）、随机延迟、鼠标键盘事件获取等）其实这里非常复杂，如浏览器的识别 ie 支持 <code>!-[1,]</code> 这个特殊JS，一些JS方言，一些浏览器有自定义标签等等；</p>
<p>2：服务端防护
url添加的尾巴（args参数）是服务器动态生成的token，而不是使用静态的正则去匹配其合法性。</p>
<p>3：特定攻击
该类特定攻击，可以通过特征快速匹配出来（慢速攻击、PHP5.3的http头攻击）</p>
<p><strong>简单场景</strong></p>
<p>1：用户可直接访问的url（这种是最好防的）</p>
<p>第一阶段：</p>
<ul>
<li>
<p>网络层：访问频率限制，超出阀值仅黑名单一段时间</p>
</li>
<li>
<p>应用层：js跳转、验证码、flash策略（拖动识别等）</p>
</li>
</ul>
<p>2：嵌入的url（ajax校验点、图片验证码）</p>
<p>第一阶段：</p>
<ul>
<li>
<p>网络层：访问频率限制，超出阀值仅黑名单一段时间</p>
</li>
<li>
<p>应用层：载入被攻击的url页面，重写页面，使用js方操作链接被攻击的url。js随机在url尾巴增加有一定规则的校验串，服务端对串进行静态正则校验。</p>
</li>
</ul>
<p>第二阶段：</p>
<ul>
<li>
<p>网络层+应用层：用户ip在http头中，需要从http头取ip，在进行频率限制
（其实做好了，这一层的防护，基本不用进入第三阶段的应用层防护了）</p>
</li>
<li>
<p>应用层：校验串使用服务端生成的token，进行严格服务器token验证检查</p>
</li>
</ul>
<p>第三阶段：</p>
<ul>
<li>应用层：js增加浏览器识别（不同agent匹配不同JS方言代码）、JS随机延迟、鼠标轨迹验证、键盘鼠标事件验证等js增加验证后，在进行校验串生成。</li>
</ul>
<p>说明：多次实战CC处理经验，很少到第三阶段，当然储备好这些JS脚本非常重要，纯JS肯定也是有限的，所有我就提出了使用控件，甚至是和浏览器厂商合作等更精准的防护方法。这样对CC攻击、页面抓取、刷单等有非常好的防护效果。</p>
<blockquote>
<p>应用层的防护是在网络层+扩展的网络层防护效果不佳时使用，一般情况基本用的不多，因为在OpenStar的防护下，极少数情况下，需要第三阶段防护。在防页面抓取时，发挥你的想象（js是个好帮手，善用）使用OpenStar就可以帮你快速实现；当然使用flash防抓取效果更好（不够灵活）。</p>
</blockquote>
<h1 id="_6">目录<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h1>
<p>后续更新！~</p>
<h1 id="_7">下载<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h1>
<p>wget</p>
<p>git clone</p>
<p><strong>已经打包的一些脚本，请参考bash目录</strong></p>
<h1 id="_8">安装<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h1>
<ul>
<li>安装OpenResty
 这里不做过多重复描述，直接看链接<a href="http://openresty.org/cn/">OpenResty</a></li>
<li>配置nginx.conf
 在http节点，引用waf.conf。注：原ngx相关配置基本不用修改，该优化优化、该做CPU亲缘绑定继续、该动静分离还继续、该IO、TIME等优化继续不要停。</li>
<li>配置waf.conf
 修改lua_package_path，使用正确的路径即可；修改那些lua文件的路径，多检查几遍。</li>
<li>设置目录权限
 OpenStar目录建议放到OR下，方便操作，该目录ngx运行用户有读写执行权限即可。因为要写日志，<em>暂时没有用ngx.log，后续可能会改动</em>。</li>
<li>lua文件修改
 在init.lua中，修改conf_json参数，base.json文件绝对路径根据自己的情况写正确。</li>
<li>api使用
2016年6月7日 23:31:09 更新啦，引用waf.conf，后就可以直接使用api接口了，通过监听5460端口来给管理用啦，界面也在筹划中，期待有人可以加入，帮我一起整界面。</li>
</ul>
<p><strong>已经打包的一些脚本，请参考bash目录，运行前请阅读一下，感谢好友余总帮助写的脚本</strong></p>
<h1 id="_9">使用<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h1>
<h2 id="_10">配置规则<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<p>一般情况下匹配某一规则由3个参数组成，第二个参数标识第一个参数类型,第三个参数表示是否取反，默认为<code>nil</code> 即 <code>false</code> 表示不取反</p>
<p>hostname：<code>["*",""]</code> = <code>["*","",false]</code></p>
<p>==&gt;表示匹配所有域名（使用字符串匹配，非正则，非常快）</p>
<p>hostname：<code>["*\\.game\\.com","jio"]</code></p>
<p>==&gt;表示使用正则匹配host（<strong>ngx.re.find($host,参数1，参数2)</strong>）</p>
<p>hostname：<code>[["127.0.0.1","127.0.0.1:8080"],"list"]</code></p>
<p>==&gt;表示匹配参数1 列表 中所有host</p>
<p>hostname：<code>[{"127.0.0.1":true,"127.0.0.1:5460":true},"dict"]</code></p>
<p>==&gt;表示匹配 字典 中host为true的host</p>
<p>uri：<code>["/admin","in"]</code></p>
<p>==&gt;表示匹配uri中包含/admin的所有uri都会被匹配（<strong>string.find($uri,参数1,1,true)</strong>）</p>
<p>ip：<code>[["127.0.0.1/32",""113.45.199.0/24""],"cidr"]</code></p>
<p>==&gt;表示匹配的ip在这两组ip段/ip中</p>
<p>args：<code>["*","",["args_name","all"],false]</code>
args：<code>["*","",["args_name","end"]]</code> = <code>["*","",["args_name","end"],false]</code>
args：<code>["*","",["args_name",1]]</code></p>
<p>说明：第3个参数表示取args参数table的key名称，第3个参数<a href="http://openresty.org/cn/">2</a>表示取args[args_name]为table时，匹配任意(all)，匹配最后一个(end),匹配第几个(数字)，默认取第一个</p>
<p>==&gt;表示匹配的GET的args参数名为args_name,使用第4个参数模式进行匹配，匹配规则就是第一个和二个参数。其中第1、2参数支持前面描述的规则方式。</p>
<p><strong>table类型的匹配规则比较麻烦，暂时想着是这样处理，有好的想法可以告诉我</strong></p>
<h2 id="_11">执行流程<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p><img alt="enter description here" src="https://github.com/starjun/openstar/raw/master/doc/Openstar.jpg" title="OpenStar.jpg" /></p>
<ul>
<li>init阶段</li>
</ul>
<p>a：首先加载本地的base.json配置文件，将相关配置读取到config_dict,host_dict,ip_dict中</p>
<ul>
<li>access阶段（自上到下的执行流程，规则列表也是自上到下按循序执行的）</li>
</ul>
<p>0：realIpFrom_Mod ==&gt; 获取用户真实IP（从HTTP头获取，如设置）</p>
<p>1：ip_Mod ==&gt; 请求ip的黑/白名单、log记录</p>
<p>2：host_method_Mod ==&gt; host和method过滤（白名单）</p>
<p>3：rewrite_Mod ==&gt; 跳转模块，set-cookie操作</p>
<p>4：host_Mod ==&gt; 对应host执行的规则过滤（uri,referer,useragent等）</p>
<div class="language-text highlight"><pre><span></span><code>这里是产品中提供给独立用户使用的过滤规则。目前支持自定义规则组（任意参数，任意组合）
</code></pre></div>
<p>5：app_Mod ==&gt; 用户自定义应用层过滤</p>
<p>6：referer_Mod ==&gt; referer过滤（黑/白名单、log记录）</p>
<p>7：uri_Mod ==&gt; uri过滤（黑/白名单、log记录）</p>
<p>8：header_Mod ==&gt; header过滤（黑名单）</p>
<p>9：useragent_Mod ==&gt; useragent过滤（黑/白名单、log记录）</p>
<p>10：cookie_Mod ==&gt; cookie过滤（黑/白名单、log记录）</p>
<p>11：args_Mod ==&gt; args参数过滤[实际是query_string]（黑/白名单、log记录）</p>
<p>12：post_Mod ==&gt; post参数过滤[实际是整个post内容]（黑/白名单、log记录）</p>
<p>13：network_Mod ==&gt; 应用层网络频率限制（频率黑名单）</p>
<ul>
<li>body阶段</li>
</ul>
<p>14：replace_Mod ==&gt; 内容替换规则（动态进行内容替换，性能消耗较高慎用，可以的话用app_Mod中rehtml、refile这2个自定义action）</p>
<h2 id="step-0-realipfrom_mod"><span id = "step0">STEP 0 : realIpFrom_Mod </span><a class="headerlink" href="#step-0-realipfrom_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
<code>{"101.200.122.200:5460": {"ips": ["*",""],"realipset": "x-for-f"}}</code></li>
</ul>
<p>通过上面的例子，表示域名id.game.com,从ips来的直连ip，用户真实ip在x-for-f中，ips是支持二阶匹配，可以参考例子进行设置，ips为*时，表示不区分直连ip了。</p>
<h2 id="step-1ip_modlog">STEP 1：ip_Mod（黑/白名单、log记录）<a class="headerlink" href="#step-1ip_modlog" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"ip":"111.206.199.61","action":"allow"}</code>
<code>{"ip":"www.game.com-111.206.199.1","action":"deny"}</code></li>
</ul>
<p>上面的例子，表示ip为111.206.199.61（从http头获取，如设置）白名单
 action可以取值[allow、deny]，deny表示黑名单；第二个就表示对应host的ip黑/白名单，其他host不受影响。</p>
<p><a href="#top">返回</a></p>
<h2 id="step-2host_method_mod"><span id = "step2">STEP 2：host_method_Mod（白名单）</span><a class="headerlink" href="#step-2host_method_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","method":[["GET","POST"],"list"],"hostname":[["id.game.com","127.0.0.1"],"list"]}</code></li>
</ul>
<p>上面的例子表示，规则开启，host为id.game.com、127.0.0.1允许的method是GET和POST
  state：表示规则是否开启
  method：表示允许的method，参数2标识参数1是字符串、列表(list)、正则、字典(dict)
  hostname：表示匹配的host，规则同上</p>
<blockquote>
<p><strong><code>"method": [["GET","POST"],"list"]</code>==&gt; 表示匹配的method是GET和POST</strong></p>
<p><strong><code>"method": ["^(get|post)$","jio"]</code> ==&gt; 表示匹配method是正则匹配</strong></p>
<p><strong><code>"hostname": ["*",""]</code> ==&gt;表示匹配任意host（字符串匹配，非正则，非常快）</strong></p>
<p><strong>后面的很多规则都是使用该方式匹配的</strong></p>
</blockquote>
<p><a href="#top">返回</a></p>
<h2 id="step-3-rewrite_mod">STEP 3: rewrite_Mod（跳转模块）<a class="headerlink" href="#step-3-rewrite_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>    {
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>        &quot;state&quot;: &quot;on&quot;,
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>        &quot;action&quot;: [&quot;set-cookie&quot;],
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    &quot;set_cookie&quot;:[&quot;asjldisdafpopliu8909jk34jk&quot;,&quot;token_name&quot;],
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>        &quot;hostname&quot;: [&quot;101.200.122.200&quot;,&quot;&quot;],
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>        &quot;uri&quot;: [&quot;^/rewrite$&quot;,&quot;jio&quot;]
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    }
</span></code></pre></div>
上面的例子表示规则启用，host为101.200.122.200,且url匹配成功的进行302/307跳转，同时设置一个无状态cookie，名称是token。action中第二个参数是用户ip+和改参数进行md5计算的。请自行使用一个无意义字符串。防止攻击者猜测出生成算法。</li>
</ul>
<p><a href="#top">返回</a></p>
<h2 id="step-4host_mod">STEP 4：host_Mod<a class="headerlink" href="#step-4host_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 该模块是匹配对应host进行规则匹配，在conf_json/host_json/目录下，本地的基于host的匹配规则
 支持host.state状态支持[on log off],log即表示原匹配被拦截将失效，off表示不做任何规则的过滤</li>
</ul>
<h2 id="step-5app_modaction"><span id = "step5">STEP 5：app_Mod（自定义action）</span><a class="headerlink" href="#step-5app_modaction" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{
    "state":"on",
    "action":["deny"],
    "hostname":["127.0.0.1",""],
    "uri":["^/([\w]{4}\.html|deny1\.do|你好\.html)$","jio"]
}</code></li>
</ul>
<p>上面的例子表示规则启用，host为127.0.0.1，且url符合正则匹配的，拒绝访问</p>
<p>state：规则是否启用
  action：执行动作</p>
<p>1：deny ==&gt; 拒绝访问</p>
<p>2：allow ==&gt; 允许访问</p>
<p>3：log ==&gt; 仅记录日志</p>
<p>4：rehtml ==&gt; 表示返回自定义字符串</p>
<p>5：refile ==&gt; 表示返回自定义文件（文件内容返回）</p>
<p>6：relua ==&gt; 表示返回lua执行脚本（使用dofile操作）</p>
<p>7：relua_str ==&gt; 表示返回lua代码执行</p>
<p>hostname：匹配的host</p>
<p>uri：匹配的uri</p>
<blockquote>
<p><strong>hostname 和 uri 使用上面描述过的匹配规则，参数2标记、参数1内容</strong></p>
<p><strong>详细参见项目中的demo规则，多实验、多测试就知道效果了</strong></p>
<p><strong>各种高级功能基本就靠这个模块来实现了，需要你发挥想象</strong></p>
</blockquote>
<p><a href="#top">返回</a></p>
<h2 id="step-6referer_mod">STEP 6：referer_Mod（白名单）<a class="headerlink" href="#step-6referer_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","uri":["\\.(gif|jpg|png|jpeg|bmp|ico)$","jio"],"hostname":["127.0.0.1",""],"referer":["*",""],"action":"allow"}</code></li>
</ul>
<p>上面的例子表示，host为127.0.0.1，uri配置的正则成功，referer正则匹配成功就放行**【这里把一些图片等静态资源可以放到这里，因为使用OpenStar，不需要将access_by_lua_file 专门放到nginx的不同的location动态节点去，这样后续的匹配规则就不对这些静态资源进行匹配了，减少总体的匹配次数，提高效率】**，action表示执行的动作，<code>allow</code>表示规则匹配成功后，跳出后续所有规则（一般对静态资源图片），referer匹配失败就拒绝访问（白名单），防盗链为主；规则的取反可以设置防护站外的CSRF</p>
<p>state：表示规则是否开启
  uri：表示匹配的uri
  hostname：匹配host
  referer：匹配referer
  action：匹配动作</p>
<blockquote>
<p>referer的匹配是白名单，注意一下即可
这些匹配都是基于上面说过的二阶匹配法</p>
</blockquote>
<p><a href="#top">返回</a></p>
<h2 id="step-7uri_mod">STEP 7：uri_Mod（黑、白名单）<a class="headerlink" href="#step-7uri_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","hostname":["\*",""],"uri":["\\.(css|js|flv|swf|zip|txt)$","jio"],"action":"allow"}</code></li>
</ul>
<p>上面的例子表示，规则启用，任意host，uri正则匹配成功后放行，不进行后续规则匹配（该场景同图片等静态资源一样进行放行，减少后续的匹配）
  state：表示规则是否开启
  hostname：表示匹配的host
  uri：表示匹配uri
  action：可取值[allow、deny、log]，表示匹配成功后的执行动作</p>
<blockquote>
<p>一般情况下，过滤完静态资源后，剩下的都是拒绝一下uri的访问如.svn等一些敏感目录或文件</p>
</blockquote>
<p><a href="#top">返回</a></p>
<h2 id="step-8header_mod">STEP 8：header_Mod（黑名单）<a class="headerlink" href="#step-8header_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","uri":["\*",""],"hostname":["\*",""],"header":["Acunetix_Aspect","\*",""]}</code></li>
</ul>
<p>上面的例子表示，规则启用，匹配任意host，任意uri，header中Acunetix_Aspect内容的匹配（本次匹配任意内容）这个匹配是一些扫描器过滤，该规则是wvs扫描器的特征
 state：规则是否启用
 uri：匹配uri
 hostname：匹配host
 header：匹配header头</p>
<p><a href="#top">返回</a></p>
<h2 id="step-9useragent_mod">STEP 9：useragent_Mod （黑名单）<a class="headerlink" href="#step-9useragent_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
  <code>{"state":"off","action":"deny","useragent":["HTTrack|harvest|audit|dirbuster|pangolin|nmap|sqln|-scan|hydra|Parser|libwww|BBBike|sqlmap|w3af|owasp|Nikto|fimap|havij|PycURL|zmeu|BabyKrokodil|netsparker|httperf|bench","jio"],"hostname":[["127.0.0.1:8080","127.0.0.1"],"list"]}</code></li>
</ul>
<p>上面的例子表示，规则关闭，匹配host为127.0.0.1 或者 127.0.0.1:8080 ，useragent正则匹配，匹配成功则拒绝访问，一般host设置为：<code>"hostname":["*",""]</code>表示所有（字符串匹配，非常快）
  state：规则是否启用
  hostname：匹配host
  useragent：匹配agent
  action：匹配动作</p>
<p><a href="#top">返回</a></p>
<h2 id="step-10cookie_mod">STEP 10：cookie_Mod（黑名单）<a class="headerlink" href="#step-10cookie_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","cookie":["\\.\\./","jio"],"hostname":["*",""],"action":"deny"}</code></li>
</ul>
<p>上面的例子表示，规则启用，匹配任意host，cookies匹配正则，匹配成功则执行拒绝访问操作
  state：表示规则是否启用
  cookie：表示匹配cookie
  hostname：表示匹配host
  action：可选参数[deny、allow] 表示执行动作</p>
<blockquote>
<p>action后续可以能增加其他action，所以预留在这，否则黑名单根本不需要action参数</p>
</blockquote>
<p><a href="#top">返回</a></p>
<h2 id="step-11args_mod">STEP 11：args_Mod（黑名单）<a class="headerlink" href="#step-11args_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","hostname":["*",""],"args_data":["\\:\\$","jio"],"action":"deny"}</code></li>
</ul>
<p>上面例子表示，规则启用，匹配任意host，query_string参数组匹配正则，成功则执行拒绝访问动作
 state：表示规则是否启用
 hostname：表示匹配host
 query_string：表示匹配args参数组
 action：表示匹配成功拒绝访问</p>
<p><a href="#top">返回</a></p>
<h2 id="step-12post_mod">STEP 12：post_Mod（黑名单）<a class="headerlink" href="#step-12post_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","hostname":["*",""],"posts_data":["\\$\\{","jio"],"action":"deny"}</code></li>
</ul>
<p>上面的例子表示，规则启用，匹配任意host,post_str参数组匹配正则，成功则拒绝访问
  state：表示是否启用规则
  hostname：匹配host
  post_str：匹配post参数组
  action：匹配成功后拒绝访问</p>
<p><a href="#top">返回</a></p>
<h2 id="step-13network_mod">STEP 13：network_Mod（频率黑名单）<a class="headerlink" href="#step-13network_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","network":{"maxReqs":20,"pTime":10,"blackTime":600},"hostname":["id.game.com",""],"uri":["^/2.html$","jio"]}</code></li>
</ul>
<p>上面的例子表示，规则启用，host为id.game.com,url匹配正则，匹配成功则进行访问频率限制，在10秒内访问次数超过20次，请求的IP到IP黑名单中10分钟（60秒*10）
  state：表示是否启用规则
  hostname：表示匹配host
  uri：表示匹配uri
  network：maxReqs ==&gt; 请求次数；pTime ==&gt; 单位时间；blacktime ==&gt; ip黑名单时长</p>
<blockquote>
<p>一般情况下，cc攻击的点一个网站只有为数不多的地方是容易被攻击的点，所以设计时，考虑增加通过url细化匹配。</p>
</blockquote>
<p><a href="#top">返回</a></p>
<h2 id="step-14replace_mod">STEP 14：replace_Mod（内容替换）<a class="headerlink" href="#step-14replace_mod" title="Permanent link">&para;</a></h2>
<ul>
<li>说明：
 <code>{"state":"on","uri":["^/$","jio"],"hostname":["passport.game.com",""],"replace_list":[["联合","","联合FUCK"],["登录","","登录POSS"],["lzcaptcha\\?key='\\s\*\\+ key","jio","lzcaptcha?keY='+key+'&amp;keytoken=@token@'"]]}</code></li>
</ul>
<p>上面的例子表示，规则启用，host为passport.game.com,url是正则匹配，匹配成功则进行返回内容替换
  1：将"联合"替换为"联合FUCK"；
  2：将"登录"替换为"登录POSS"；
  3：通过正则进行匹配（<code>ngx.re.gsub</code>）其中<a class="magiclink magiclink-github magiclink-mention" href="https://github.com/token" title="GitHub User: token">@token</a>@表示动态替换为服务器生成的一个唯一随机字符串
  state：表示是否启用规则
  hostname：表示匹配的host
  uri：表示匹配的uri
  replace_list：表示替换列表，参数1 ==&gt; 被替换内容；参数2 ==&gt; 匹配模式（正则、字符串）如例子中前2个替换列表就是字符串匹配，使用""即可，不能没有；参数3 ==&gt; 被替换的内容</p>
<h1 id="api">API相关<a class="headerlink" href="#api" title="Permanent link">&para;</a></h1>
<p>参考doc目录下的api.md说明</p>
<h1 id="_12">样例<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h1>
<ul>
<li>参见doc下，demo.md说明</li>
</ul>
<h1 id="_13">性能评测<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h1>
<p><strong>操作系统信息</strong>
OpenStar测试服务器：</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a> 微软虚机，内网测试
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a> uname -a :
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a> Linux dpicsvr01 4.2.0-30-generic #36-Ubuntu SMP Fri Feb 26 00:58:07 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a> 内存：
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a> cat /proc/meminfo | grep MemTotal
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a> MemTotal:       14360276 kB// 14GB
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a> CPU型号：cat /proc/cpuinfo | grep &#39;model name&#39; |uniq
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a> Intel(R) Xeon(R) CPU E5-2660 0 @ 2.20GHz
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a> CPU核数：cat /proc/cpuinfo | grep &quot;cpu cores&quot; | uniq
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a> 4
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a> CPU个数：cat /proc/cpuinfo | grep &quot;physical id&quot; | uniq | wc -l
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a> 1
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a> ab：
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a> ab -c 1000 -n 100000 &quot;http://10.0.0.4/test/a?a=b&amp;c=d&quot;
</span></code></pre></div>
测试结果：
<img alt="enter description here" src="https://github.com/starjun/openstar/raw/master/doc/test.png" title="test.png" />
 通过图片可以看到，关闭所有规则，做了2组测试，取最高的<code>8542</code>；</p>
<p>启用规则（排除app，network，replace），测试结果<code>8388</code>，性能下降<code>1.81%</code>；</p>
<p>启用规则（排除replace，app中未启用relua这个高消耗点），测试结果<code>7959</code>，性能下降<code>6.83%</code>；</p>
<p>启用规则（排除useragent，ab工具默认被拦截了，第二个测试就不完全了。）测试结果<code>7116</code>，性能下降<code>16%</code>；</p>
<p>总的来说，启用规则后，性能损失可以接受，根据自身的业务进行调整，还可以有所优化。</p>
<!--auto_detail_active_begin_e1c6fb434b6f0baf6912c7a1934f772b-->
<h2 id="_14">项目相关<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<h2 id="_15">最近更新<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h2>
<!--auto_detail_active_end_f9cf7911015e9913b7e691a7a5878527-->












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../MysqlT/" class="md-footer__link md-footer__link--prev" aria-label="上一页: MysqlT">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                MysqlT
              </div>
            </div>
          </a>
        
        
          
          <a href="../passive-scan-client/" class="md-footer__link md-footer__link--next" aria-label="下一页: passive-scan-client">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                passive-scan-client
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/probiusofficial" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/probiusofficial" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://space.bilibili.com/27109929" target="_blank" rel="noopener" title="space.bilibili.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0s16.1 2.868 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0c8.8 0 16.1 2.868 21.9 8.603 5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1zm-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8 6.3-6.5 9.7-14.3 10.1-23.5V173.8zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5-9.6 0-17.5-3.2-23.6-9.5-6.1-6.3-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2 6.3-6.3 13.2-9.6 23.3-10 9.2.4 17 3.7 23.3 10zm191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.1 6.3-14 9.5-23.6 9.5-9.6 0-17.4-3.2-23.6-9.5-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2 6.3-6.3 14.1-9.6 23.3-10 9.2.4 17 3.7 23.3 10z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<probiuslinx@gmail.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>